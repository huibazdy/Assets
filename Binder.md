

> 学习Binder并将其与传统IPC方式对比，有助于深入理解IPC实现与优化。



# Binder引入

## 传输性能

常见的进程间通信（IPC）方式有：socket、管道、System V IPC（消息队列、共享内存、信号量）等。在安卓IPC场景下，都有各自的局限性。

* **socket**

    通用接口，传输效率低，开销大。主要用于跨网络IPC以及本机低速IPC。

* **消息队列与管道**

    这两种采用存储转发方式，即：将数据从发送方缓冲区拷贝至内核开辟的缓冲区中，然后再将数据从内核缓冲区拷贝至接收方缓冲区。至少存在两次拷贝。

* **共享内存**

    无需数据拷贝，但控制复杂，难以使用。



## 安全性

传统IPC方式本身没有任何安全措施，完全依赖上层协议来确保安全性。Android应用程序来源广泛，需要防范下载的程序在用户不知情的情况下窃取隐私数据、连接无线网、操作底层设备导致功耗高等情况。

首先，传统IPC无法鉴别对方身份，即进程的UID或PID。原因是传统IPC只能由用户在数据包中填入UID或PID。这样做的结果是，容易被恶意程序利用。

可靠的身份标记只能由IPC机制本身在内核中添加。

其次，传统IPC访问接入点是开放的，无法建立私有通道。如命名管道的名称、system V的键值、socket的IP地址以及文件名。只要知道这些接入点的信息，都可以和对端建立连接。因此无论怎样都无法阻止恶意程序建立链接。

因此，基于对传输性能和安全性的考虑，Android提出了一种新的IPC方式，就是Binder。



# Binder通信模型

Binder作为安卓主要的IPC方式。



# Binder通信协议





# 参考资料

1. [Binder设计篇](https://blog.csdn.net/universus/article/details/6211589)