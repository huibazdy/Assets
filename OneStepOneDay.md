# 0206

- [ ] ==函数指针==
- [ ] ==回调函数==



> ***什么是函数指针？***

类似于变量，函数也是有自己的地址的。所谓函数的地址，就是函数代码的起始处的地址。而函数指针中存储的就是函数代码的起始地址。

函数指针的声明必须指明函数的类型，这就包括函数签名（返回类型、形参类型），例如一个函数原型为：

`void toUpper(char *);     //函数原型`

声明一个指向该函数的指针`pFunc`：

`void (*pFunc)(char *);   //声明函数指针`

可以看出：**将函数名替换为指针表达式**是创建函数指针最简单的方式，注意此处**必须使用小括号**。所以，如果想声明一个指向某函数的指针，只需先写出该函数的原型，然后用指针表达式替换函数名即可。

声明了函数指针后，需要将该函数的地址传递给该指针，方法就是用**函数名充当地址**值赋给指针：

`pFunc = toUpper;        //赋予函数地址`     



> ***如何使用函数指针？***

就像数据指针可以访问数据，函数指针也可以直接访问函数。给出实参：`char name[] = "Eric";`通过函数指针来调用函数的写法：

1. `(*pFunc)(name);  //等同于：toUpper(name);`
2. `pFunc(name);    //等同于：toUpper(name);`

函数指针最常见的用法是作为函数的参数：

```c
void show(void (*pFunc)(char *) ,char * str);
```

以上函数声明了两个参数，一个是函数指针pFunc，另一个是数据指针str。如果存在以上声明，你可以这样调用函数show：

1. `show(toUpper,name);`
2. `show(pFunc,name);`



把带返回值的函数作为参数传递给另一个函数有两种不同使用方法：

1. `func1(sqrt);    //传递函数地址`
2. `func2(sqrt(4.0));    //传递函数返回值`



> ***什么是回调函数？***

回调函数是一种使用函数的机制。它可以使某个函数（简记为函数`F1`）像传递参数那样传递给另一个函数（简记为函数`F2`）。

该机制的实现基础是**函数指针**。

回调：说明`F1`不是由该函数的实现方直接调用，而是对某种事件的响应，需要由`F2`而间接调用`F1`。

使用回调函数的例子：

```c
#include<stdio.h>

int Callback1(int a){
    printf("This is Callback 1,answer is: %d\n",a);
}
int Callback2(int b){
    printf("This is Callback 1,answer is: %d\n",2 * b);
}

int Handle(int x, int (*pf)(int)){
    pf(x);
}

int main()
{
    Handle(1,Callback1);
    Handle(2,Callback2);
    return 0;
}
```



